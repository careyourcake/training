<!DOCTYPE html>
<html>

<head>
    <title>语音识别表单输入</title>
</head>

<body>

    <h1>语音识别表单输入</h1>

    <form>
        <label for="speechInput">语音输入：</label>
        <input type="text" id="speechInput" name="speechInput" placeholder="开始说话..." > 
        <button type="button" id="startButton">开始识别</button>
    </form>
    
</body>
<script>
    // 获取表单元素和按钮
    var speechInput = document.getElementById("speechInput");
    var startButton = document.getElementById("startButton");

    // 创建语音识别对象
    var recognition = new webkitSpeechRecognition(); // Chrome浏览器需使用webkitSpeechRecognition

    // 设置语音识别参数
    recognition.continuous = true; // 连续识别模式，设置为true后就不会识别一段对话后马上停止，而是会等待一段时间，实时对话中非常有用
    recognition.interimResults = true; // 设为true后，即使没讲完，也会先显示部分内容

    // 开始语音识别， 用addEventListener向语音识别对象添加事件监听器
    startButton.addEventListener("click", function () {
        recognition.start();
    });

    // 处理语音识别结果
    recognition.onresult = function (event) {
        var transcript = "";
        for (var i = event.resultIndex; i < event.results.length; i++) {
            //判断是否是最终的结果即识别是否结束
            if (event.results[i].isFinal) {
                transcript += event.results[i][0].transcript; //语音实际上是放在一个二维数组里，第一个元素是索引，第二个元素是候选项（置信度），0的置信度最高
            }
        }
        speechInput.value = transcript; //赋值到id为speechInput的元素中
    };

    // 处理语音识别错误
    recognition.onerror = function (event) {
        console.error("语音识别错误：" + event.error);
    };
</script>

</html>